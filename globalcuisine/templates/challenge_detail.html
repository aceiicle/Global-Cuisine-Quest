{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <h2>{{ challenge.title }}</h2>
    <p><strong>Description:</strong> {{ challenge.description }}</p>
    <p><strong>Posted by:</strong> {{ challenge.author.username }} on {{ challenge.created_at.strftime('%Y-%m-%d') }}</p>

    {% if current_user.is_authenticated %}
    <form action="{{ url_for('main.accept_challenge', challenge_id=challenge.id) }}" method="post">
        <input type="hidden" name="challenge_id" value="{{ challenge.id }}">
        <button type="submit" class="btn btn-success">Accept Challenge</button>
    </form>
    {% else %}
    <p><a href="{{ url_for('auth.login') }}">Log in</a> to accept this challenge.</p>
    {% endif %}

    <hr>

    <h4>Submissions</h4>
    {% if submissions %}
        <div class="list-group">
            {% for submission in submissions %}
                <a href="{{ url_for('main.submission_detail', submission_id=submission.id) }}" class="list-group-item list-group-item-action">
                    <h5 class="mb-1">{{ submission.author.username }}'s submission</h5>
                    <p class="mb-1">{{ submission.comment | truncate(100) }}</p>
                    <small>Submitted on {{ submission.created_at.strftime('%Y-%m-%d') }}</small>
                </a>
            {% endfor %}
        </div>
    {% else %}
        <p>No submissions yet. Be the first to accept and complete this challenge!</p>
    {% endif %}
</div>
{% endblock %}
